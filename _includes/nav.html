{% assign cur_family = "" %}

{% assign control_counter = 0 %}
{% assign family_counter = 0 %}


<div class="panel-group" id="accordionMenu" role="tablist" aria-multiselectable="false">

{% for control in site.data.fedramp_controls["Controls"] %}

    {% if cur_family != control.Family %}
        {% assign cur_family = control.Family %}
    
        {% assign family_menu_id = "menu_" | append: family_counter  %}
        {% assign control_menu_id = "menu_child_" | append: control_counter  %}

        <div class="panel panel-default">
          <div class="panel-heading" role="tab" id="{{ family_menu_id }}">
            <h4 class="panel-title">
            <a role="button" data-toggle="collapse" data-parent="#accordionMenu" href="#{{ control_menu_id }}" aria-expanded="true" aria-controls="{{ control_menu_id }}">
              {{ cur_family }}
            </a>
          </h4>
          </div>
          <div id="{{ control_menu_id }}" class="panel-collapse collapse in" role="tabpanel" aria-labelledby=" {{family_menu_id }}">
            <div class="panel-body">
              <ul>
                {% for control in site.data.fedramp_controls["Controls"] %}
                    {% if control.Family == cur_family %}
                    {% assign control_anchor = "control_section_" | append: control.ID | replace: "-", "" %}

                        <li><a href="#{{ control_anchor }}">{{ control.ID }} {{ control.TITLE }}</a></li>
                        {% assign control_counter = control_counter | plus:1 %}

                    {% endif %}

                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
        {% assign family_counter = family_counter | plus:1 %}
  
  


  {% endif %}

  

{% endfor %}
          
</div>
